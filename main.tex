\documentclass{article}

\usepackage[utf8]{inputenc}
% \usepackage[round]{natbib}
\usepackage[english]{babel}
\usepackage{amsfonts}
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{amssymb}
\usepackage{dsfont}
\usepackage{url}
\usepackage{hyperref}
\usepackage{tikz-cd}
\usepackage{mathpartir}
\usepackage{mathtools}
\usepackage{enumitem}
\usepackage{color}

\mathtoolsset{showonlyrefs}

\newcommand{\todo}[1]{\textcolor{red}{#1}}

\newtheorem{theorem}{Theorem}
\newtheorem{corollary}{Corollary}
\newtheorem{lemma}{Lemma}
\newtheorem{definition}{Definition}
\newtheorem{definition-proposition}{Definition and Proposition}
\newtheorem{proposition}{Proposition}
\newtheorem{assumption}{Assumption}

\begin{document}

\title{A model of extensional type theory in a model category of locally cartesian closed categories}

\author{Martin E.\@ Bidlingmaier}

\maketitle

\begin{abstract}
  \todo{TODO}
\end{abstract}

\section{Introduction}

Locally cartesian closed (lcc) categories are natural categorical models of extensional dependent type theory \cite{lcc-categories-and-type-theory}:
Given some lcc category $\mathcal{C}$, one interprets
\begin{itemize}
  \item
    contexts $\Gamma$ as objects of $\mathcal{C}$;
  \item
    (simultaneous) substitutions from $\Delta$ to $\Gamma$ as morphisms $f : \Delta \rightarrow \Gamma$ in $\mathcal{C}$;
  \item
    types $\Gamma \vdash \sigma$ as morphisms $\sigma : \operatorname{dom} \sigma \rightarrow \Gamma$ in $\mathcal{C}$ with codomain $\Gamma$; and
  \item
    terms $\Gamma \vdash s : \sigma$ as sections $s : \Gamma \rightleftarrows \operatorname{dom} \sigma : \sigma$ to the interpretations of types.
\end{itemize}
A context extension $\Gamma.\sigma$ is interpret as the domain of $\sigma$, substitution in types $\Gamma \vdash \sigma$ along substitutions $f : \Delta \rightarrow \Gamma$ is interpreted as pullback
\begin{equation}
  \begin{tikzcd}
    \operatorname{dom} \sigma[f] \arrow[r] \arrow[d, "{\sigma[f]}"] \arrow[dr, phantom, near start, "\lrcorner"] & \operatorname{dom} \sigma \arrow[d, "\sigma"] \\
    \Delta \arrow[r, "f"] & \Gamma
  \end{tikzcd}
\end{equation}
and similarly for terms $\Gamma \vdash s : \sigma$.
In lcc categories, the pullback functors $f^* : \mathcal{C}_{/ \Gamma} \rightarrow \mathcal{C}_{/ \Delta}$ are part of adjunctions $\Sigma_f \dashv f^* \dashv \Pi_f$ which are used for interpreting $\mathbf{\Sigma}$-types and $\mathbf{\Pi}$-types.
For example, the interpretations of types $\Gamma \vdash \sigma$ and $\Gamma.\sigma \vdash \tau$ is a pair of morphisms $\Gamma.\sigma.\tau \xrightarrow{\tau} \Gamma.\sigma \xrightarrow{\sigma} \Gamma$, and then $\Gamma \vdash \mathbf{\Pi}_\sigma \, \tau$ is interpreted as $\Pi_\sigma(\tau)$, which is an object of $\mathcal{C}_{/ \Gamma}$, i.e.\@ a morphism into $\Gamma$.

However, there is a slight mismatch:
Syntactic substitution is functorial and commutes strictly with type formers, whereas pullback is generally only pseudo-functorial and preserves universal objects only up to isomorphism.
Here functoriality of substitution means that if one has a sequence $\mathcal{E} \xrightarrow{g} \Gamma \xrightarrow{f} \Delta$ of substitutions, then we have equalities $\sigma[g][f] = \sigma[gf]$ and $s[g][f] = s[gf]$, i.e.\@ substituting in succession yields the same result as substituting with the composition.
For pullback functors, however, we are only guaranteed a natural isomorphism $g^* \cong f^* \cong (g \circ f)^*$.
Similarly, in type theory we have $(\mathbf{\Pi}_\sigma \, \tau)[f] = \mathbf{\Pi}_{\sigma[f]} \, \tau[f^+]$ (where $f^+$ denotes the weakening of $f$ along $\sigma$), whereas for pullback functors there exist merely isomorphisms $f^*(\Pi_\sigma \, \tau) \cong \Pi_{f^*(\sigma)} \, (f^+)^*(\tau)$.

In response to these problems, several notions of models with strict pullback operations have been introduced, e.g.\@ categories with families (cwf) \cite{internal-type-theory}, and coherence techniques have been developed to ``strictify'' weak models such as lcc categories to obtain models with well-behaved substitution \cite{substitution-up-to-isomorphism,on-the-interpretation-of-type-theory-in-lcc-categories,the-local-universes-model}.
Thus to interpret dependent type theory in some lcc category $\mathcal{C}$, one first builds an equivalence $\mathcal{C} \simeq \mathcal{C}^s$ of lcc categories so that $\mathcal{C}^s$ can endowed with the structure of a strict model of type theory (say, cwf structure) and interprets type theory in $\mathcal{C}^s$.

In this paper, we construct cwf structure on the category of all lcc categories (as opposed to on some specific lcc category), and show how this cwf structure can be used to solve the original coherence problem.
A crucial aspect will be the concrete presentation of the category of lcc categories in terms of a 1-category:
The category of lcc categories is most naturally understood as a $(2, 1)$-category, where the invertible 2-cells are natural isomorphisms of lcc functors.
$(2, 1)$-categories are a special case of $(\infty, 1)$-categories, and as such are amenable to presentations in terms of model categories \todo{cite}.
Model categories are 1-categories equipped with structure that is used to encode higher categorical phenomena in 1-categorical terms.
The choice of presenting model category is not unique, and we will explore three model categories, all of which encode the same higher category of lcc categories:
First the category $\mathrm{Lcc}$ of lcc sketches (section \ref{sec:lcc-sketches}), then the category $\mathrm{sLcc}$ (section \ref{sec:strict-lcc-categories}) of strict lcc categories, and finally the category $\operatorname{Coa} \mathrm{sLcc}$ of algebraically cofibrant strict lcc categories (section \ref{sec:algebraically-cofibrant}).
We then show that $\operatorname{Coa} \mathrm{sLcc}$ admits cwf structure supporting unit, extensional equality, $\mathbf{\Pi}$ and $\mathbf{\Sigma}$ types (theorem \ref{th:lcc-supports-types}).

In which sense can the category of lcc categories be understood as a model of type theory?
First note that the classical interpretation of type theory in an lcc category $\mathcal{C}$ is essentially an interpretion in the slice categories of $\mathcal{C}$:
\begin{itemize}
  \item
    objects $\Gamma \in \operatorname{Ob} \mathcal{C}$ can be identified with slice categories $\mathcal{C}_{/ \Gamma}$;
  \item
    morphisms $f : \Delta \rightarrow \Gamma$ can be identified with lcc functors $f^* : \mathcal{C}_{/ \Gamma} \rightarrow \mathcal{C}_{/ \Delta}$ which commute with the pullback functors $\Gamma^* : \mathcal{C} \rightarrow \mathcal{C}_{/ \Gamma}$ and $\Delta^* : \mathcal{C} \rightarrow \mathcal{C}_{/ \Delta}$;
  \item
    morphisms $\sigma : \operatorname{dom} \sigma \rightarrow \Gamma$ with codomain $\Gamma$ can be identified with the objects of the slice categories $\mathcal{C}_{/ \Gamma}$; and
  \item
    sections $s : \Gamma \leftrightarrows \operatorname{dom} \sigma : \sigma$ can be identified with morphisms $1 \rightarrow \sigma^*(\sigma)$ in the slice category $\mathcal{C}_{/ \operatorname{dom} \sigma}$.
\end{itemize}
Removing all reference to the base category $\mathcal{C}$, we may now attempt to interpret
\begin{itemize}
  \item
    each context $\Gamma$ as a separate lcc category;
  \item
    a substitution from $\Delta$ to $\Gamma$ as an lcc functor $f : \Gamma \rightarrow \Delta$;
  \item
    types $\Gamma \vdash \sigma$ as objects $\sigma \in \operatorname{Ob} \Gamma$; and
  \item
    terms $\Gamma \vdash s : \sigma$ as morphisms $s : 1 \rightarrow \sigma$ from a terminal object $1$ to $\sigma$, where $1$ denotes a terminal object.
\end{itemize}
In the original interpretation, substitutions of types and terms was defined in terms of the lcc pullback functors $f^* : \mathcal{C}_{/ \Gamma} \rightarrow \mathcal{C}_{/ \Delta}$ along morphisms $f : \Delta \rightarrow \Gamma$.
In the new interpretation, $f$ is already an lcc functor, which we simply apply to objects and morphisms of lcc categories.
To avoid having to dualize twice, we introduce the notion of \emph{covariant cwf}, which is a category $\mathcal{C}$ whose opposite is equipped with cwf structure.
We refer to morphisms in a covariant cwf as \emph{cosubstitutions}.
Intuitively, substitutions $f : \Delta \rightarrow \Gamma$ in cwfs are given by assignments of terms in $\Delta$ to the variables of $\Gamma$; a cosubstitution $f : \Gamma \rightarrow \Delta$ can thus be understood as an interpretation of $\Gamma$'s variables as terms in context $\Delta$.
In line with the interpretion of cosubstitutions as lcc functors, we denote substitution of types and terms $\Gamma \vdash s : \sigma$ along a cosubstitution $f : \Gamma \rightarrow \Delta$ by function application, i.e.\@ $\Delta \vdash f(s) : f(\sigma)$.
To make our idea of an interpretation of dependent type theory precise, we should now construct a cwf structure on the category of lcc categories and show that it satisfies the required equalities.
Unfortunately this fails for very similar reason as the na√Øve interpretation of type theory in a fixed lcc category:
Like pullback functors, lcc functors preserve lcc structure only up to ismorphism and not necessarily up to equality.
Furthermore, the obvious choice for context extension along a type $\Gamma \vdash \sigma$, the slice category $\Gamma.\sigma = \Gamma_{/ \sigma}$, has the required universal property only in the 2-categorical sense:
The category of lcc functors $f : \Gamma \rightarrow \Delta$ and terms $\Delta \vdash w : f(\sigma)$ with natural isomorphisms of lcc functors is equivalent, but not isomorphic, to the category of lcc functors $k : \Gamma_{/ \sigma} \rightarrow \Delta$ which commute with the pullback functor $\sigma^* : \Gamma \rightarrow \Gamma_{/ \sigma}$ and map the diagonal $\sigma \rightarrow \sigma \times \sigma$ in $\Gamma_{/ \sigma}$ to $w$.

\section{Lcc sketches}
\label{sec:lcc-sketches}

As outlined earlier, the solution to these problems is a suitable model categorical presentation of the $(2, 1)$-category of lcc categories.
As a preliminary step, we define a model category $\mathrm{Lcc}$ of locally cartesian closed (lcc) sketches, which presents the $(2, 1)$-category of lcc categories.
Intuitively, lcc sketches are categories in which certain diagrams are marked as supposed to have a certain universal property but not required to actually satisfy it.
Thus an lcc sketch comes with squares marked as pullback squares, with objects marked as terminal objects and diagrams marked as dependent products their evaluation maps, but none of these are required to actually satisfy the universal property.
However, lcc category can be identified with their underlying lcc sketches, which are given by marking all diagrams as having a certain universal property if and only if they actually satisfy it.
Because the morphisms in $\mathrm{Lcc}$ are defined as functors which preserve marking, lcc functors of lcc categories can be identified with morphisms of underlying sketches.

The model category structure of $\mathrm{Lcc}$ is set up such that its fibrant objects are precisely the lcc categories, and general lcc sketches are equivalent if and only if the lcc categories they generate by fibrant replacement are equivalent.
Thus $\mathrm{Lcc}$ can be seen as a model categorical presentation of the $(2, 1)$-category of lcc categories, lcc functors and their natural isomorphisms.

\begin{definition}[\cite{marked-objects} Definition 2.1]
  Let $\mathcal{C}$ be a category.
  Let $i : I \rightarrow \mathcal{C}$ be a functor from a small category $I$ to $\mathcal{C}$.
  An \emph{($i$-)marked object} is given by an object $X$ in $\mathcal{C}$ and a subfunctor $m_X$ of $\mathrm{Hom}(i(-), X) : I^\mathrm{op} \rightarrow \mathrm{Set}$.
  A map of the form $k : i(K) \rightarrow X$ is \emph{marked} if $k \in m_X(K)$.

  A morphism of $i$-marked objects is a marking-preserving morphism of underlying objects in $\mathcal{C}$, i.e.\@ a morphism $f : X \rightarrow Y$ such that the image of $m_X$ under postcomposition by $f$ is contained in $m_Y$.
  The category of $i$-marked objects is denoted by $\mathcal{M}^i$.
\end{definition}

The forgetful functor $U : \mathcal{C}^i \rightarrow \mathcal{C}$ has a left and right adjoint:
Its left adjoint $X \mapsto X^\flat$ is given by equipping an object $X$ of $\mathcal{C}$ with the minimal marking $m_{X^\flat} = \emptyset \subseteq \mathrm{Hom}(i(-), X)$, while the right adjoint $X \mapsto X^\sharp$ equips objects with their maximal marking $m_{X^\sharp} = \mathrm{Hom}(i(-), X)$.

In our application, $I$ contain diagrams corresponding to the shape of lcc structure.
The morphisms in $I$ are used to enforce that the domains of maps marked as evaluation maps are marked as pullback squares.

\begin{definition}
  The small subcategory $I_\mathrm{Lcc} \subseteq \mathrm{Cat}$ of \emph{lcc shapes} is given by the terminal category 
  \begin{equation}
    \mathrm{T} =
    \left\{
      \begin{tikzcd}
        t
      \end{tikzcd}
    \right\}
  \end{equation}
  consisting of a single object $t$, the free standing (non-commutative) square
  \begin{equation}
    \mathrm{Pb} =
    \left\{
      \begin{tikzcd}
        \cdot \arrow[d, "p_1"] \arrow[r, "p_2"] & \cdot \arrow[d, "f_2"] \\
        \cdot \arrow[r, "f_1"] & \cdot
      \end{tikzcd}
    \right\}
  \end{equation}
  and the diagram
  \begin{equation}
    \mathrm{Pi} =
    \left\{
      \begin{tikzcd}
        \cdot \arrow[ddr, bend right, "p_1"] \arrow[drr, bend left, "p_2"] \arrow[dr, "\varepsilon"] \\
        & \cdot \arrow[d, "g"] & \cdot \arrow[d, "f_2"] \\
        & \cdot \arrow[r, "f_1"] & \cdot
      \end{tikzcd}
    \right\}.
  \end{equation}
  The only non-trivial functor in $I_\mathrm{Lcc}$ is the inclusion $\mathrm{Pb} \subseteq \mathrm{Pi}$ given by the outer square of $\mathrm{Pi}$ as indicated by the variable names.

  We obtain the category $\mathrm{Cat}^{I_\mathrm{Lcc}}$ of \emph{lcc-marked categories}.
\end{definition}

Logical theories are usually defined as a pair of signature $\Sigma$ and a set of $\mathcal{T}$ of axioms over the signature $\Sigma$.
To define a notion of model, one then defines a structure which interprets the operations and relations in $\Sigma$, and then defines the models of $(\Sigma, \mathcal{T})$ to be those $\Sigma$-structures which satisfy the axioms $\mathcal{T}$.

Similarly, the model structure on the category of lcc-marked categories is defined in 2-step process:
First, a model structure corresponding to $\Sigma$-structures is constructed.
This model structure identifies lcc-marked categories if their choice of marking differs only within isomorphism classes.

\begin{theorem}[\cite{marked-objects} Theorem 3.3]
  \label{th:marked-model-category}
  Let $\mathcal{M}$ be a combinatorial model category $\mathcal{M}$.
  Let $i : I \rightarrow \mathcal{M}$ be functor from a small category $I$ to $\mathcal{M}$.
  Then the following defines the structure of a combinatorial model category on $\mathcal{M}^i$:
  \begin{itemize}
    \item
      A marking-preserving morphism $f : X \rightarrow Y$ is a cofibration if and only if it is a cofibration in $\mathcal{M}$.
    \item
      \todo{
        Describe weak equivalences, preferably without referring to a fibrant replacment functor.
        See \cite{marked-objects} Lemma 2.5.
      }
    \item
      A marked object $X$ is fibrant if and only if $U(X)$ is fibrant in $\mathcal{M}$ and marked maps are stable under homotopy in $\mathcal{M}$, in the sense that if $k \simeq \ell : F(K) \rightarrow U(X)$ are homotopic maps in $\mathcal{M}$ and $k$ is marked, then $\ell$ is marked.
      \todo{This can be removed if the previous point is there (in itself it's also not enough to determine the model category structure uniquely)}
  \end{itemize}
  Let $I$ be a set of generating cofibrations of $\mathcal{M}$.
  Then the set
  \begin{equation}
    I' = \{ i^\flat \mid i \in I \} \cup \{ K^\flat \rightarrow (K, G\{\mathrm{id} : K \rightarrow K\}) \mid K \in \mathcal{K} \}
  \end{equation}
  generates the cofibrations of $\mathcal{M}_K$.
  \todo{
    Can we say something about generating trivial cofibrations?
    In the case where every object of $\mathcal{M}$ is fibrant this is the obvious thing (see proof in \cite{marked-objects}, but I'm doubtful whether this works in general.
  }
  Moreover, the adjunctions $(-)^\flat \dashv U$ and $U \dashv (-)^\sharp$ are Quillen adjunctions.
\end{theorem}

\begin{lemma}
  Suppose that in the setting of theorem \ref{th:marked-model-category} $\mathcal{M}$ is furthermore a simplicial model category.
  Then $\mathcal{M}^i$ is a simplicial model category, and $(-)^\flat \dashv U$ and $U \dashv (-)^\sharp$ are simplicial Quillen adjunctions.
\end{lemma}
\begin{proof}
  The mapping spaces of $\mathcal{C}^i(X, Y)$ are given by the subspaces of $\mathcal{C}(X, Y)$ consisting of the marking preserving maps.
  The power $X^S$ of a marked object $X$ by a simplicial set $S$ is given by the power $U(X)^S$ in $\mathcal{M}$ in which $k : i(K) \rightarrow U(X)^S$ is marked if and only if the composite $K \rightarrow U(X^G) \xrightarrow{\mathrm{id}^s} U(X)$ is marked for every vertex $s : \Delta^0 \rightarrow S$.
  Dually, the tensor $S \otimes X$ is given the underlying tensor $S \otimes U(X)$, and maps $k : K \rightarrow U(S \otimes X)$ are marked if and only if they factor as $K \xrightarrow{k} U(X) \xrightarrow{s \otimes \mathrm{id}} S \times U(X)$ for some $s : \Delta^0 \rightarrow S$ and $k$ marked in $U(X)$.
  \todo{Proof that this indeed works (see also \cite{marked-objects} Lemma 3.4)}
\end{proof}

So far, the model structure is not aware of what kind of universal property marked diagrams are supposed to have, much like structures interpreting logical signatures are defined without reference to a set of axioms they might satisfy.
To obtain a model category of lcc sketches, we \emph{localize} at a set of morphisms which encode the axioms of lcc categories:
We want to consider lcc-marked categories equivalent if they represent the same lcc category.

\begin{definition}
  The model category $\mathrm{Lcc}$ of lcc sketches is the left Bousfield localization of the model category of $I_\mathrm{Lcc}$-marked objects at the following cofibrations.
  \begin{itemize}
    \item
      There exists a terminal object:
      \begin{equation}
        \emptyset \rightarrow \{ t \}
      \end{equation}
      (in which $t$ is marked via $T$ in the codomain).
    \item
      There is morphism from every object to every terminal object:
      \begin{equation}
        \left\{
          \begin{tikzcd}
            \cdot & t
          \end{tikzcd}
        \right\}
        \rightarrow
        \left\{ 
          \begin{tikzcd}
            \cdot \arrow[r] & t
          \end{tikzcd}
        \right\} 
      \end{equation}
      (where $t$ is marked via $\mathrm{T}$ in domain and codomain).
    \item
      Any two morphisms with the same domain and terminal codomain are equal:
      \begin{equation}
        \left\{
          \begin{tikzcd}
            \cdot \arrow[r, shift left] \arrow[r, shift right] & t
          \end{tikzcd}
        \right\}
        \rightarrow
        \left\{ 
          \begin{tikzcd}
            \cdot \arrow[r] & t
          \end{tikzcd}
        \right\} 
      \end{equation}
      (where $t$ is marked via $\mathrm{T}$ in domain and codomain).
    \item
      Pullback squares commute:
      \begin{equation}
        \left\{
          \begin{tikzcd}
            \cdot \arrow[r, "p_2"] \arrow[d, "p_1"] & \cdot \arrow[d, "f_2"] \\
            \cdot \arrow[r, "f_1"] & \cdot
          \end{tikzcd}
        \right\}
        \rightarrow
        \left\{
          \begin{tikzcd}
            \cdot \arrow[dr, phantom, "\circlearrowleft"] \arrow[r, "p_2"] \arrow[d, "p_1"] & \cdot \arrow[d, "f_2"] \\
            \cdot \arrow[r, "f_1"] & \cdot
          \end{tikzcd}
        \right\}
      \end{equation}
      (where the squares in domain and codomain are marked via $\mathrm{Pb}$ but only the latter commutes).
    \item
      Every cospan can be completed to a pullback square:
      \begin{equation}
        \left\{
          \begin{tikzcd}
            & \cdot \arrow[d, "f_2"] \\
            \cdot \arrow[r, "f_1"] & \cdot 
          \end{tikzcd}
        \right\}
        \rightarrow
        \left\{
          \begin{tikzcd}
            \cdot \arrow[r, "p_2"] \arrow[d, "p_1"] & \cdot \arrow[d, "f_2"] \\
            \cdot \arrow[r, "f_1"] & \cdot
          \end{tikzcd}
        \right\}
      \end{equation}
      (where the domain is minimally marked and the square in the codomain is marked via $\mathrm{Pb}$).
    \item
      Every square completing a cospan factors via any pullback square over that cospan:
      \begin{equation}
        \left\{
          \begin{tikzcd}
            \cdot \arrow[ddr, bend right, "q_1"'] \arrow[drr, bend left, "q_2"] \arrow[dr, phantom, "\circlearrowleft", near end] \\
            & \cdot \arrow[d, "p_1"] \arrow[r, "p_2"] & \cdot \arrow[d, "f_2"] \\
            & \cdot \arrow[r, "f_1"] & \cdot
          \end{tikzcd}
        \right\}
        \rightarrow
        \left\{
          \begin{tikzcd}
            \cdot \arrow[ddr, bend right, "q_1"'] \arrow[ddr, phantom, "\circlearrowleft"] \arrow[drr, bend left, "q_2"] \arrow[drr, phantom, "\circlearrowleft"] \arrow[dr] \\
            & \cdot \arrow[d, "p_1"] \arrow[r, "p_2"] & \cdot \arrow[d, "f_2"] \\
            & \cdot \arrow[r, "f_1"] & \cdot
          \end{tikzcd}
        \right\}
      \end{equation}
      (where the lower right squares are marked via $\mathrm{Pb}$ and the large squares commute in domain and codomain).
    \item
      Every two factorizations via a pullback square are equal:
      \begin{equation}
        \left\{
          \begin{tikzcd}
            \cdot \arrow[ddr, bend right, "q_1"'] \arrow[ddr, phantom, "\circlearrowleft"] \arrow[drr, bend left, "q_2"] \arrow[drr, phantom, "\circlearrowleft"] \arrow[dr, shift left] \arrow[dr, shift right] \\
            & \cdot \arrow[d, "p_1"] \arrow[r, "p_2"] & \cdot \arrow[d, "f_2"] \\
            & \cdot \arrow[r, "f_1"] & \cdot
          \end{tikzcd}
        \right\}
        \rightarrow
        \left\{
          \begin{tikzcd}
            \cdot \arrow[ddr, bend right, "q_1"'] \arrow[ddr, phantom, "\circlearrowleft"] \arrow[drr, bend left, "q_2"] \arrow[drr, phantom, "\circlearrowleft"] \arrow[dr] \\
            & \cdot \arrow[d, "p_1"] \arrow[r, "p_2"] & \cdot \arrow[d, "f_2"] \\
            & \cdot \arrow[r, "f_1"] & \cdot
          \end{tikzcd}
        \right\}
      \end{equation}
      (where the lower right squares are marked via $\mathcal{B}$ and the large squares commute in domain and codomain).
      \todo{Make more explicit that the two parallel arrows both separately commute with $q_1$ and $q_2$}
    \item
      A dependent product $f_2 = \Pi_{f_1} g$ exists for every appropriate pair of morphisms:
      \begin{equation}
        \left\{
          \begin{tikzcd}
            & \cdot \arrow[d, "g"] \\
            & \cdot \arrow[r, "f_1"] & \cdot
          \end{tikzcd}
        \right\}
        \rightarrow
        \left\{
          \begin{tikzcd}
            \cdot \arrow[ddr, bend right, "p_1"] \arrow[drr, bend left, "p_2"] \arrow[dr, "\varepsilon"] \\
            & \cdot \arrow[d, "g"] & \cdot \arrow[d, "f_2"] \\
            & \cdot \arrow[r, "f_1"] & \cdot
          \end{tikzcd}
        \right\}
      \end{equation}
      (where the codomain is marked via $\mathrm{Pb}$ and $\mathrm{Pi}$ as indicated by the variable names).
    \item
      The evaluation map $\varepsilon$ commutes with the projection map:
      \begin{equation}
        \left\{
          \begin{tikzcd}
            \cdot \arrow[ddr, bend right, "p_1"] \arrow[drr, bend left, "p_2"] \arrow[dr, "\varepsilon"] \\
            & \cdot \arrow[d, "g"] & \cdot \arrow[d, "f_2"] \\
            & \cdot \arrow[r, "f_1"] & \cdot
          \end{tikzcd}
        \right\}
        \rightarrow
        \left\{
          \begin{tikzcd}
            \cdot \arrow[ddr, bend right, "p_1"] \arrow[ddr, phantom, "\circlearrowleft", near end] \arrow[drr, bend left, "p_2"] \arrow[dr, "\varepsilon"] \\
            & \cdot \arrow[d, "g"] & \cdot \arrow[d, "f_2"] \\
            & \cdot \arrow[r, "f_1"] & \cdot
          \end{tikzcd}
        \right\}
      \end{equation}
    \item
      Any other morphism with an evaluation map factors via dependent products:
      \begin{equation}
        \left\{
          \begin{tikzcd}
            \cdot \arrow[dddrr, bend right, "p'_1"] \arrow[ddrrrr, bend left, "p'_2"] \arrow[ddrr, bend right] & \\
            & \cdot \arrow[ddr, bend right, "p_1"] \arrow[drr, bend left, "p_2"] \arrow[dr, "\varepsilon"] \\
            & & \cdot \arrow[d, "g"] & \cdot \arrow[d, "f_2"] & \cdot \arrow[dl, "f'_2"] \\
            & & \cdot \arrow[r, "f_1"] & \cdot
          \end{tikzcd}
        \right\}
        \rightarrow
        \left\{
          \begin{tikzcd}
            \cdot \arrow[dr] \arrow[dddrr, bend right, "p'_1"] \arrow[ddrrrr, bend left, "p'_2"] \arrow[ddrr, bend right] & \\
            & \cdot \arrow[ddr, bend right, "p_1"] \arrow[drr, bend left, "p_2"] \arrow[dr, "\varepsilon"] \\
            & & \cdot \arrow[d, "g"] & \cdot \arrow[d, "f_2"] & \cdot \arrow[dl, "f'_2"] \arrow[l] \\
            & & \cdot \arrow[r, "f_1"] & \cdot
          \end{tikzcd}
        \right\}
      \end{equation}
      \todo{(where several squares and triangle commute.)}
    \item
      Any two such factorizations via an evaluation map are equal:
      \todo{absolute mess}
  \end{itemize}
\end{definition}

\begin{proposition}
  The subcategory of fibrant objects of the category of $\mathrm{Lcc}$ is equivalent to the category of lcc categories and lcc functors.
  The homotopy category of $\mathrm{Lcc}$ is equivalent to the category of lcc categories and isomorphism classes of lcc functors.
  The homotopy function complexes of fibrant lcc sketches are given by the groupoids of lcc functors and their natural isomorphisms.
\end{proposition}
\begin{proof}
  \todo{
    The fibrant objects of $\mathrm{Lcc}$ are fibrant marked categories which are local wrt.\@ the morphisms defined above, and a direct but lengthy calculation shows that these are precisely lcc categories.
    Every object is cofibrant, so the other claims follow from the way the mapping groupoids of marked objects (and hence also in the localization) are defined.
  }
\end{proof}

\section{Strict lcc categories}
\label{sec:strict-lcc-categories}

As explained in the introduction, our ultimate goal is to define an interpretation of extensional dependent type theory in which contexts are interpreted as lcc categories, substitutions as lcc functors, types as objects in lcc categories and terms as morphisms with terminal domain.
However, the category $\mathrm{Lcc}$ defined in \ref{sec:lcc-sketches} is not suitable for this purpose:
All type theoretic structure has the be preserved up to equality by substitutions, but lcc functors preserve the corresponding objects with universal properties only up to isomorphism.
Luckily $\mathrm{Lcc}$ is just one particular presentation of the $(2, 1)$-category of lcc categories, and so we may hope to find alternative presentations which are more suitable for interpreting type theory.
In this section, we explain results from the literature for building such alternative descriptions.
As a first step, we have to rectify the fact that lcc functors do not preserve lcc structure up to equality.
Indeed, the way we have defined lcc sketches and categories, we cannot even state when an lcc functor is strict because there is no canonical choice of lcc structure.
Lcc categories are fibrant lcc sketches, which means that they have the right lifting \emph{property} against the generating trivial cofibrants of $\mathrm{Lcc}$.
In order to speak of canonical choices of lcc structure, we need canonical lifts against the trivial cofibrations.

\begin{definition}[\cite{algebraic-models}]
  Let $\mathcal{M}$ be a combinatorial model category with set $J$ of generating trivial cofibrations.
  An \emph{algebraically fibrant object} of $\mathcal{M}$ (with respect to $J$) consists of an object $X \in \operatorname{Ob} \mathcal{M}$ equipped with a choice of lifts against all morphisms $j \in J$.
  Thus $X$ comes with choices of lifts $\ell_{j, a} : B \rightarrow X$ for all $j : A \rightarrow B$ in $J$ and $a : A \rightarrow X$ in $\mathcal{M}$ such that
  \begin{equation}
    \begin{tikzcd}
      A \arrow[d, "j"] \arrow[r, "a"] & X \\
      B \arrow[ur, "{\ell_{j, a}}"']
    \end{tikzcd}
  \end{equation}
  commutes.
  A morphism of algebraically fibrant objects $f : (X, \ell) \rightarrow (X', \ell')$ is a morphism $f : X \rightarrow X'$ that preserves the lifts $\ell$, in the sense that $f\ell_{j, a} = \ell'_{fj, fa}$ for all $j$ and $a$.
  The category of algebraically fibrant objects is denoted by $\operatorname{Alg} \mathcal{M}$, and the evident forgetful functor $\operatorname{Alg} \mathcal{M} \rightarrow \mathcal{M}$ by $G$.
\end{definition}

\begin{theorem}[\cite{algebraic-models} Proposition 2.4, \cite{equipping-weak-equivalences} Theorem 19]
  \label{th:algebraically-fibrant-model-category}
  Suppose $\mathcal{M}$ is a combinatorial model category.
  Then $G$ is monadic with left adjoint $F$.
  The model structure of $\mathcal{M}$ can be transferred along the adjunction $F \dashv G$ to $\operatorname{Alg} \mathcal{M}$.
  $\operatorname{Alg} \mathcal{M}$ is a combinatorial model category, and $F \dashv G$ is a Quillen equivalence.
\end{theorem}

Thus with theorem \ref{th:algebraically-fibrant-model-category} we have found an equivalent model for the category of lcc categories:
\begin{definition}
  The model category of strict lcc categories and strict lcc functors is given by $\mathrm{sLcc} = \operatorname{Alg} \mathrm{Lcc}$.
\end{definition}

An interpretation of dependent type theory in $\mathrm{sLcc}$ seems much more feasible at first:
As before, types are interpreted as objects in (now strict) lcc categories, and cosubstitutions as (strict) lcc functors.
$\mathrm{sLcc}$ is a model category and hence has an initial object which is given by applying the left adjoint $F$ to the empty sketch.
Context extension by a type $\Gamma \vdash \sigma$ can be constructed as a pushout
\begin{equation}
  \label{eq:slcc-context-extension}
  \begin{tikzcd}
    F(\{t, \sigma\}) \arrow[r] \arrow[d] & F(\{v : t \rightarrow \sigma \}) \arrow[d] \\
    \Gamma \arrow[r, "p"] & \Gamma.\sigma
  \end{tikzcd}
\end{equation}
where $t$ is marked as terminal in the two lcc sketches in the top, and the left vertical arrow is induced by $\sigma \in \operatorname{Ob} \Gamma$ and the canonical terminal object of $\Gamma$.

Type constructors are interpreted using the canonical lcc structure of a strict lcc category, and the fact that morphisms in $\mathrm{sLcc}$ are functors preserving the canonical structure on the nose means that type constructors are also preserved on the nose, as required by the rules of dependent type theory.
Unit types are interpreted by the canonical terminal object of strict lcc categories.
Having chosen a fixed method of constructing equalizers from pullback squares, we can interpret equality types $\operatorname{Eq} s \, t$ of terms $s, t : \sigma$ in a context $\Gamma$ as equalizer of $s$ and $t$.

However, we run into a problem when interpreting $\Pi$- or $\Sigma$-types.
The type forming rule for $\Pi$-types is
\begin{equation}
  \inferrule
  {\Gamma \vdash \sigma \\ \Gamma.\sigma \vdash \tau}
  {\Gamma \vdash \Pi_\sigma \tau}.
\end{equation}
To interpret it, we would like to apply the dependent product functor $\Gamma_{/ \sigma} \rightarrow \Gamma$ to $\tau$.
But $\tau$ is an object of $\Gamma.\sigma$, so we need a comparison functor $D : \Gamma.\sigma \rightarrow \Gamma_{/ \sigma}$.
An obvious attempt at doing so is the use of the universal property of $\Gamma.\sigma$ as context extension:
The pullback functor $\sigma^* : \Gamma \rightarrow \Gamma_{/ \sigma}$ is lcc and the diagonal $d : \sigma \rightarrow \sigma \times \sigma$ induces a term $\Gamma_{\sigma} \vdash d' : \sigma \times \sigma$ in $\Gamma_{/ \sigma}$.
However, the pullback functor $\sigma^*$, while lcc, is usually not strict lcc, but the universal property of $\Gamma$ requires a strict lcc functor.

\section{Algebraically cofibrant strict lcc categories}
\label{sec:algebraically-cofibrant}

As a starting point to remedy the situation, recall that the slice category $\Gamma_{/ \sigma}$ of an lcc category $\Gamma$ (or any category with finite limits) is bifreely generated from the pullback functor $\sigma^* : \Gamma \rightarrow \Gamma_{/ \sigma}$ and the diagonal of $\sigma$, which in $\Gamma_{/ \sigma}$ is up to isomorphism a morphism from the terminal object to $\sigma^*(\sigma)$.
Phrased model categorically, bifreeness amounts to saying that the square
\begin{equation}
  \label{eq:homotopy-pushout-lcc}
  \begin{tikzcd}
    \{ t, x \} \arrow[r] \arrow[d] & \{ v : t \rightarrow x \} \arrow[d] \\
    \Gamma \arrow[r, "x^*"] & \Gamma_{/ x}
  \end{tikzcd}
\end{equation}
is a homotopy pushout square in $\mathrm{Lcc}$.
Similarly to the pushout square \eqref{eq:slcc-context-extension}, the left vertical arrow is given by sending the object $t$ to some terminal object of $\mathcal{C}$.
Equivalently, the two lcc sketches appearing in the top row with their weakly equivalent fibrant replacements, giving us essentially the same top left span as in \eqref{eq:slcc-context-extension} but in $\mathrm{Lcc}$.
Because $\mathrm{Lcc}$ and $\mathrm{sLcc}$ are Quillen equivalent, we should thus expect $\mathcal{C}_{/ x}$ and $\mathcal{C}.x$ to be weakly equivalent if the pushout square \eqref{eq:slcc-context-extension} is a homotopy pushout square.
By \todo{Lurie somewhere, see also nlab}, \eqref{eq:slcc-context-extension} is a homotopy pushout if the three objects forming the upper left span are cofibrant and on of the the left or right legs are cofibrations.
The cofibrations of $\mathrm{Lcc}$ are the maps whose underlying functors are injective on objects.
Thus $\{t, \sigma\}$ and $\{ v : t \rightarrow \sigma\}$ are cofibrant lcc sketches, and the inclusion of the former into the latter is a cofibration.
$F$ is a left Quillen functor and so preserves cofibrations.
Thus the conditions of \todo{ibd.} are satisfied if $\Gamma$ is cofibrant, and in this case we should expect a weak equivalence relating $\Gamma.\sigma$ with $\Gamma_{/ \sigma}$.

Note that the composite $FG : \mathrm{sLcc} \rightarrow \mathrm{Lcc} \mathrm{sLcc}$ is a cofibrant replacement functor because $F \dashv G$ is a Quillen equivalence and every object in $\mathrm{Lcc}$ is cofibrant.
It follows that a strict lcc category $\Gamma$ is cofibrant if and only if the counit $F(G(\Gamma)) \rightarrow \Gamma$ is a retraction, say with section $\lambda : \Gamma \rightarrow F(G(\Gamma))$.
This retraction can be used to strictify the pullback functor:
We have $\sigma^* : G(\Gamma) \rightarrow G(\Gamma)_{/ \sigma}$, which induces a strict lcc functor $\overline{\sigma^*} : F(G(\Gamma)) \rightarrow \Gamma_{/ \sigma}$ by adjointness.
Now $\sigma^s = \lambda \circ \overline{\sigma^*} : \Gamma \rightarrow \Gamma_{/ \sigma}$.
$G(\sigma^s)$ is naturally equivalent to $\sigma^*$ because \todo{TODO}.
It follows that the diagonal $d$ can be pre- and postcomposed with this natural equivalence, giving a term of type $\sigma^s(\sigma)$ in $\Gamma_{/ \sigma}$, which induces the required comparison functor $D : \Gamma.\sigma \rightarrow \Gamma_{/ \sigma}$.
Given $\Gamma.\sigma \vdash \tau$, we might then define $\Gamma \vdash \Pi_\sigma \, \tau$ as the image of $\tau$ under the composite $\Gamma.\sigma \xrightarrow{D} \Gamma_{/ \sigma} \xrightarrow{\Pi_\sigma} \Gamma$.
As a first attempt, we might thus restrict the category of contexts to the cofibrant strict lcc categories.
Indeed, cofibrant objects are stable under pushouts, along cofibrations, thus context extensions $\Gamma.\sigma$ will be cofibrant again if $\Gamma$ was.
However, the definition of the comparison functor $D : \Gamma.\sigma \rightarrow \Gamma_{/ \sigma}$ required a \emph{choice} of retraction $\lambda : \Gamma \rightarrow F(G(\Gamma))$, and some choices will not be compatible with even strict lcc functors $\Gamma \rightarrow \Delta$.
Thus the $\Pi$-types defined such will not be stable under substitution.

To solve this issue, we make the retraction $\lambda$ part of the structure:
Similarly to how strict lcc categories have associated structure corresponding to their fibrancy in lcc, we make the retraction $\lambda$ witnessing the cofibrancy of strict lcc categories part of the data.
We thus consider coalgebraically fibrant objects, which, dually to algebraically fibrant objects, are defined as coalgebras for a cofibrant replacement comonad.
Like in the case of algebraically fibrant objects, we are justified in doing so because we obtain an equivalent model category:

\begin{theorem}[\cite{coalgebraic-models} Lemmas 1.2 and 1.3, Theorems 1.4 and 2.5]
  \label{th:coalgebraic-model-category}
  Let $\mathcal{M}$ be a combinatorial and simplicial model category.
  Then there are arbitrarily large cardinals $\lambda$ such that
  \begin{enumerate}
    \item
      $\mathcal{M}$ is is locally $\lambda$-presentable;
    \item
      $\mathcal{M}$ is cofibrantly generated with a set of generating cofibrations for which domains and codomains are $\lambda$-presentable objects;
    \item
      an object $X \in \mathcal{M}$ is $\lambda$-presentable if and only if the functor $\mathrm{Hom}(X, -) : \mathcal{M} \rightarrow \mathrm{Set}$, given by the simplicial enrichment of $\mathcal{M}$, preserves $\lambda$-filtered colimits.
  \end{enumerate}

  Let $\lambda$ be any such cardinal.
  Then there is a simplicially-enriched cofibrant replacement comonad $C : \mathcal{M} \rightarrow \mathcal{M}$ that preserves $\lambda$-filtered colimits. 
  Let $C$ be any such comonad.
  Denote the category of its coalgebras by $\operatorname{Coa} \mathcal{M}$.
  The forgetful functor $U : \operatorname{Coalg} \mathcal{M} \rightarrow \mathcal{M}$ has a left adjoint $V$.
  $\operatorname{Coa} \mathcal{M}$ has the structure of a simplicially enriched category with tensors and powers, and $V \dashv U$ is a simplicial adjunction.
  The model category structure of $\mathcal{M}$ can be transferred along $V \dashv U$, making $\operatorname{Coa} \mathcal{M}$ a simplicial and combinatorial model category.
  $V \dashv U$ is a simplicial Quillen equivalence.
\end{theorem}

In our case, the first infinite cardinal $\omega$ satisfies the three conditions of theorem \ref{th:coalgebraic-model-category}, and $C = FG$ can be chosen as a cofibrant replacement comonad.
\todo{
  Verify this.
  Conditions (1) and (2) are clear.
  For condition (3), I think it suffices by the proof in \cite{coalgebraic-models} that
  \begin{align}
    & \mathrm{Hom}(\Delta^n \otimes \mathcal{C}, \operatorname{colim}_i \mathcal{D}_i) \\
    \cong {} & \mathrm{Hom}(\mathcal{C}, (\operatorname{colim}_i \mathcal{D}_i)^{\Delta^n}) \\
    \cong {} & \mathrm{Hom}(\mathcal{C}, \operatorname{colim}_i (\mathcal{D}_i^{\Delta^n})) \\
    \cong {} & \operatorname{colim}_i \mathrm{Hom}(\mathcal{C}, \mathcal{D}_i^{\Delta^n}) \\
    \cong {} & \mathrm{Hom}(\Delta^n \otimes \mathcal{C}, \operatorname{colim}_i \mathcal{D}_i) 
  \end{align}
  if $\mathcal{C}$ is finitely presentable and the $\mathcal{D}_i$ are filtered.
}

This is the final ingredient into solving the coherence condition, so we are ready to define a CwF.

\begin{definition}
  The covariant cwf of lcc categories $\mathbf{Lcc}$ is given as follows.
  \begin{itemize}
    \item
      Its category of contexts $\Gamma$ and cosubustitions $f : \Delta \rightarrow \Gamma$ is given by $\operatorname{Coa} \mathrm{sLcc}$.
    \item
      Types $\Gamma \vdash \sigma$ in a context $\Gamma$ are objects of $\Gamma$.
    \item
      Terms $\Gamma \vdash s : \sigma$ of type $\sigma$ in  context $\Gamma$ are morphisms $1 \rightarrow \sigma$ in $\Gamma$, where $1$ denotes the canonical terminal object of $\Gamma$.
    \item
      Application of cosubstituions to types and terms is given by application of strict lcc functors to objects and morphisms in their domain.
  \end{itemize}
\end{definition}

\begin{lemma}
  Let $\lambda : \Gamma \rightarrow F(G(\Gamma))$ be a coalgebra for $FG$.
  Then there is a canonical natural isomorphism $\phi : G(\lambda) \cong \eta_{G(\Gamma)} : G(\Gamma) \rightarrow G(F(G(\Gamma)))$ for lcc functors, which is compatible with morphisms of $FG$-coalgebras.
\end{lemma}
\begin{proof}
  By one of the triangle identities and $\lambda$ being a coalgebra, we have
  \begin{equation}
    G(\varepsilon_\Gamma \circ \lambda) = G(\varepsilon_\Gamma) \circ \eta_{G(\Gamma)} = \mathrm{Id} : G(\Gamma) \rightarrow G(\Gamma).
  \end{equation}
  Because $F \dashv G$ is a Quillen equivalence, the composite $\eta_{G(\Gamma)} \circ G(\varepsilon_\Gamma) : G(\Gamma) \rightarrow G(\Gamma)$ is naturally isomorphic to the identity.
  A natural isomorphism $\theta : G(F(G(\Gamma)) \rightarrow G(F(G(\Gamma)))^{\Delta^1}$ can be constructed explicitly using the inserter \todo{finish proof}.
\end{proof}

\begin{proposition}
  The cwf $\mathbf{Lcc}$ has an empty context and all context extensions.
\end{proposition}
\begin{proof}
  $\operatorname{Coa} \mathrm{sLcc}$ is a model category and in particular cocomplete, hence posesses an initial object, i.e.\@ an empty context.
  \todo{Explicity description?}

  \todo{
    Spell out the proof on my board for context extension.
    The underlying strict lcc category is the strict context extension as explained before.
    Its comonad structure $\Gamma.\sigma \rightarrow FG(\Gamma)$ is defined by the universal property and the previous lemma.
    Its universal property among coalgebra morphisms is again verified with the universal property (it amounts to proving that two strict lcc functors with domain $\Gamma.\sigma$ are equal).
  }
\end{proof}

\begin{lemma}
  \label{lem:extension-to-slice}
  For each context $\lambda : \Gamma \rightarrow F(G(\Gamma))$ and type $\Gamma \vdash \sigma$ there is a strict lcc functor $D : \Gamma.\sigma \rightarrow \Gamma_{/ \sigma}$ which is a weak equivalence in $\mathrm{sLcc}$.
  The construction of $D = D_{\lambda, \sigma}$ is natural with respect to coalgebra morphisms $f : (\Gamma, \lambda) \rightarrow (\Delta, \mu)$, in the sense that
  \begin{equation}
    \begin{tikzcd}
      \Gamma.\sigma \arrow[d, "D_{\lambda, \sigma}"] \arrow[r, "f.\sigma"] & \Delta.f(\sigma) \arrow[d, "D_{\mu, f(\sigma)}"] \\
      \Gamma_{/ \sigma} \arrow[r, "f_{/ \sigma}"] & \Delta_{/ f(\sigma)}
    \end{tikzcd}
  \end{equation}
  commutes.
\end{lemma}
\begin{proof}
  \todo{This is basically explained in the meta of this chapter---the problem there was that $\lambda$ might not be preserved, but this is fixed now.}
\end{proof}

\begin{theorem}
  \label{th:lcc-supports-types}
  The cwf $\mathbf{Lcc}$ supports unit, extensional equality, $\mathbf{\Pi}$ and $\mathbf{\Sigma}$ types.
\end{theorem}
\begin{proof}
  As explained earlier unit types can be interpreted as canonical terminal objects and equality types as equalizers (which can be constructed uniformly from pullback squares).
  \todo{
    Should probably be worked out properly at least once somewhere.
    Maybe this can be done in the previous section for just strict lcc categories, and then I can handwave that it works the same here.
  }

  \emph{$\mathbf{\Pi}$-types.}
  Let $\Gamma \vdash \sigma$ and $\Gamma.\sigma \vdash \tau$.
  Then $\Gamma \vdash \mathbf{\Pi}_\sigma \, \tau$ is defined as $\Pi_\sigma(D(\tau))$, where $D : \Gamma.\sigma \rightarrow \Gamma_{/ \sigma}$ is as in lemma \ref{lem:extension-to-slice} and $\Pi_\sigma : \Gamma_{/ \sigma} \rightarrow \Gamma$ is the canonical right adjoint to the canonical pullback functor (\todo{should probably say what's meant by ``canonical'' here: It's a version of $\Pi$ constructed (uniformly for all slcc categories) from the canonical lifts of strict lcc categories.}
  $D$ and $\Pi_\sigma$ are natural with respect to cosubstitutions, so the $\Pi$-types defined such are stable under substitution.

  Now let $\Gamma.\sigma \vdash t : \tau$.
  We must construct a lambda abstraction $\Gamma \vdash \mathbf{\lambda}(t) : \mathbf{\Pi}_\sigma \, \tau$.
  This is done by mapping $t$ to $\Gamma_{/ \sigma}$ using the comparison functor $D$ as above, and using the adjunction $\sigma^* \dashv \Pi_\sigma$ to obtain a morphism $\mathbf{\lambda}(t) : \top \rightarrow \Pi_\sigma(D(\tau))$ in $\Gamma$ from the morphism $\sigma^*(\top) \xrightarrow{\sim} \top \xrightarrow{D(t)} D(\tau)$ in $\Gamma_{/ \sigma}$.
  Here the morphism $\sigma^*(\top) \xrightarrow{\sim} \top$ can be explictly constructed from the strict lcc structure of $\Gamma$, hence is stable under substitution.
  Application of $\Gamma \vdash u : \mathbf{\Pi}_\sigma \, \tau$ to the variable in an extended context $\Gamma.\sigma \vdash \mathbf{App}(u)$ is constructed along the same lines. \todo{explain more}
  The required equations hold because of adjointness \todo{explain more}
  \todo{
    Actually, this can maybe be done somewhat more elegant by first proving that cwf has $\Pi$ types iff there is an adjunction among categories of terms in context or something.
    The category of terms in context is likely equivalent isomorphic to the context (i.e.\@ the underlying slcc category) itself.
  }

  \todo{
    $\Sigma$-types, but that's probably also easier handled first purely in term of categories of terms in context.
  }
\end{proof}

\section{Recovering an interpretation in a single lcc category}

This section is devoted to showing that theorem \ref{th:lcc-supports-types} allows recovery of type theory in a given lcc category.

\begin{lemma}
  Let $\mathbf{C}$ be a covariant cwf and let $\Gamma \in \mathbf{C}$ be a context.
  Then the coslice category $\mathbf{C}_{\Gamma /}$ carries the structure of a covariant cwf such that the canonical inclusion $\mathbf{C}_{\Gamma /} \rightarrow \mathbf{C}$ preserves all structure of covariant cwfs except for the empty context and is full on types and terms.
  \qed
\end{lemma}

\begin{theorem}
  \label{th:context-as-model}
  Let $\Gamma \in \mathbf{Lcc}$ be an algebraically cofibrant strict lcc category.
  Denote by $\mathbf{Lcc}_{| \Gamma}$ the least covariant cwf of $\mathbf{Lcc}_{\Gamma /}$ that is full on types and terms.
  Then the category of contexts and cosubstitions of $\mathbf{Lcc}_{| \Gamma}$ is equivalent to $\Gamma^\mathrm{op}$.
\end{theorem}
\begin{proof}
  We construct a functor $H : \Gamma^\mathrm{op} \rightarrow \mathbf{Lcc}_{| \Gamma}$.
  We have $H(\sigma) = \Gamma.\sigma$.
  Let $f : \sigma \rightarrow \tau$ be a morphism in $\Gamma$.
  Then $f$ determines a morphism $1 \rightarrow \sigma^*(\tau)$ in $\Gamma_{/ \sigma}$ via the isomorphisms $1 \cong \mathrm{id}_\sigma$ and $\sigma^*(\tau) \cong \sigma \times \tau$.
  In turn, this morphism determines a term $\Gamma.\sigma \vdash f' : p_\sigma(\tau)$ via the equivalence $D_{\lambda, \tau} : \Gamma.\sigma \xrightarrow{\simeq} \Gamma_{/ \sigma}$.
  Now we let $H(f) = \langle p_\sigma, f' \rangle : \Gamma.\tau \rightarrow \Gamma.\sigma$.
  
  $\mathbf{Lcc}_{| \Gamma}$ is democratic by construction, thus $H$ is essentially surjective.
  \todo{
    Full + faithful follows from equivalences isos
    \begin{align}
      & \mathrm{Hom}(\sigma, \tau) \\
      \simeq {} & \mathrm{Hom}_\mathrm{Lcc}(\Gamma_{/ \tau} , \Gamma_{/ \sigma}) \\
      \simeq {} & \mathrm{Hom}_\mathrm{sLcc}(\Gamma.\tau, \Gamma.\sigma)
    \end{align}
    for cofibrant $\Gamma$, where the first and third Hom-categories are discrete and the middle one is only discrete up to equivalence.
    (The lcc and slcc functor categories have to be taken in category under $\Gamma$.)
  }
\end{proof}

By the Quillen equivalences $\mathrm{Lcc} \simeq \mathrm{sLcc} \simeq \mathbf{Lcc}$, every lcc category is equivalent to an algebraically cofibrant strict lcc category, i.e.\@ to a context in $\mathbf{Lcc}$, which by theorem \ref{th:context-as-model} is equivalent to a cwf supporting extensional ML type theory.

\section{Conclusion}

The main insight so far was that the coherence problems in interpretations of type theory can be solved by assuming a global point of view:
Instead of insisting on an interpretation in a given fixed lcc category, we interpret type theory in the category of all such categories, and theorem \ref{th:context-as-model} shows that we can recover from this single ``gros'' model a model in any fixed lcc category.
The main advantage of working globally is that we can use the machinery of model category theory, which works best for locally presentable categories.
While a given lcc category will often not be locally presentable, the category of all lcc categories is (at least when seen as a higher category).

\bibliographystyle{alpha}

\bibliography{main}

\end{document}
